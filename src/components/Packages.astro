---
---

<section
  class="section packages-section"
  id="packages"
  role="region"
  aria-labelledby="packages-title"
>
  <div class="container">
    <header class="section-header">
      <img
        id="packages-title"
        class="packages-title-image"
        src="/img/title/PNGPACKAGES.png"
        alt="Packages"
      />
      <p class="section-subtitle">
        Choose your perfect surfing adventure package
      </p>
    </header>

    <div class="packages-swiper-container">
      <div class="swiper packages-swiper">
        <div class="swiper-wrapper">
          <!-- Pkg 1 -->
          <div class="swiper-slide">
            <div class="pkg-card" data-id="1" data-base-price="750000">
              <div class="pkg-header">
                <span class="pkg-tag">Best Value</span>
                <h3 class="pkg-title">Surf & Camp</h3>
                <div class="pkg-price-box">
                  <span class="currency">Rp</span>
                  <span class="amount">750K</span>
                  <span class="duration">/ 2D1N</span>
                </div>
              </div>
              <div class="pkg-body">
                <ul class="pkg-features">
                  <li>
                    <span class="icon">üèÑ‚Äç‚ôÇÔ∏è</span>
                    <span class="text">Basic surfing lessons</span>
                  </li>
                  <li>
                    <span class="icon">üèïÔ∏è</span>
                    <span class="text">Camp accommodation</span>
                  </li>
                  <li>
                    <span class="icon">üçΩÔ∏è</span>
                    <span class="text">3 meals & drinks</span>
                  </li>
                  <li>
                    <span class="icon">üì∏</span>
                    <span class="text">Photo documentation</span>
                  </li>
                  <li>
                    <span class="icon">üöê</span>
                    <span class="text">Transport included</span>
                  </li>
                  <li>
                    <span class="icon">üèûÔ∏è</span>
                    <span class="text">Trekking to Pengilon Hill</span>
                  </li>
                </ul>

                <div class="pkg-footer">
                  <!-- Pax -->
                  <div class="pax-control-wrapper">
                    <span class="pax-label">Pax</span>
                    <div class="pax-controls">
                      <button class="pax-btn decrease" aria-label="Decrease pax"
                        >-</button
                      >
                      <span class="pax-number">1</span>
                      <button class="pax-btn increase" aria-label="Increase pax"
                        >+</button
                      >
                    </div>
                  </div>

                  <!-- Total -->
                  <div class="pax-total-box">
                    <span class="label">Total Price</span>
                    <span class="value pax-total">Rp 750K</span>
                  </div>

                  <a href="#" class="btn btn-primary book-btn">Book Now</a>
                </div>
              </div>
            </div>
          </div>

          <!-- Pkg 5 (New) -->
          <div class="swiper-slide">
            <div class="pkg-card" data-id="5" data-base-price="750000">
              <div class="pkg-header">
                <h3 class="pkg-title">Sore di desa, Pagi di ombak</h3>
                <div class="pkg-price-box">
                  <span class="currency">Rp</span>
                  <span class="amount">750K</span>
                  <span class="duration">/ 2D1N</span>
                </div>
              </div>
              <div class="pkg-body">
                <ul class="pkg-features">
                  <li>
                    <span class="icon">üèÑ‚Äç‚ôÇÔ∏è</span>
                    <span class="text">Basic surfing lessons</span>
                  </li>
                  <li>
                    <span class="icon">üè°</span>
                    <span class="text">Village homestay</span>
                  </li>
                  <li>
                    <span class="icon">üçΩÔ∏è</span>
                    <span class="text">3 meals</span>
                  </li>
                  <li>
                    <span class="icon">üèñÔ∏è</span>
                    <span class="text">Beach access</span>
                  </li>
                  <li>
                    <span class="icon">üì∏</span>
                    <span class="text">Photo documentation</span>
                  </li>
                  <li>
                    <span class="icon">üöê</span>
                    <span class="text">Transport</span>
                  </li>
                  <li>
                    <span class="icon">üåÖ</span>
                    <span class="text">Village cultural experience</span>
                  </li>
                </ul>

                <div class="pkg-footer">
                  <div class="pax-control-wrapper">
                    <span class="pax-label">Pax</span>
                    <div class="pax-controls">
                      <button class="pax-btn decrease">-</button>
                      <span class="pax-number">1</span>
                      <button class="pax-btn increase">+</button>
                    </div>
                  </div>

                  <div class="pax-total-box">
                    <span class="label">Total Price</span>
                    <span class="value pax-total">Rp 750K</span>
                  </div>

                  <a href="#" class="btn btn-primary book-btn">Book Now</a>
                </div>
              </div>
            </div>
          </div>

          <!-- Pkg 2 -->
          <div class="swiper-slide">
            <div class="pkg-card" data-id="2" data-base-price="350000">
              <div class="pkg-header">
                <h3 class="pkg-title">One Day Trip</h3>
                <div class="pkg-price-box">
                  <span class="currency">Rp</span>
                  <span class="amount">350K</span>
                  <span class="duration">/ 1 Day</span>
                </div>
              </div>
              <div class="pkg-body">
                <ul class="pkg-features">
                  <li>
                    <span class="icon">üèÑ‚Äç‚ôÇÔ∏è</span>
                    <span class="text">Basic surfing lessons</span>
                  </li>
                  <li>
                    <span class="icon">üèñÔ∏è</span>
                    <span class="text">Beach Exploring</span>
                  </li>
                  <li>
                    <span class="icon">üèûÔ∏è</span>
                    <span class="text">Trekking to Pengilon Hill</span>
                  </li>
                  <li>
                    <span class="icon">üì∏</span>
                    <span class="text">Photo documentation</span>
                  </li>
                  <li>
                    <span class="icon">üöê</span>
                    <span class="text">Transport included</span>
                  </li>
                  <li>
                    <span class="icon">‚ú®</span>
                    <span class="text">Fun & Friendly Guide</span>
                  </li>
                </ul>

                <div class="pkg-footer">
                  <div class="pax-control-wrapper">
                    <span class="pax-label">Pax</span>
                    <div class="pax-controls">
                      <button class="pax-btn decrease">-</button>
                      <span class="pax-number">1</span>
                      <button class="pax-btn increase">+</button>
                    </div>
                  </div>

                  <div class="pax-total-box">
                    <span class="label">Total Price</span>
                    <span class="value pax-total">Rp 350K</span>
                  </div>

                  <a href="#" class="btn btn-primary book-btn">Book Now</a>
                </div>
              </div>
            </div>
          </div>

          <!-- Pkg 3 -->
          <div class="swiper-slide">
            <div class="pkg-card" data-id="3" data-base-price="250000">
              <div class="pkg-header">
                <h3 class="pkg-title">Surf Only</h3>
                <div class="pkg-price-box">
                  <span class="currency">Rp</span>
                  <span class="amount">250K</span>
                  <span class="duration">/ Session</span>
                </div>
              </div>
              <div class="pkg-body">
                <ul class="pkg-features">
                  <li>
                    <span class="icon">üèÑ‚Äç‚ôÇÔ∏è</span>
                    <span class="text">1 Hour Lesson</span>
                  </li>
                  <li>
                    <span class="icon">üåä</span>
                    <span class="text">Surfboard rental</span>
                  </li>
                  <li>
                    <span class="icon">üë®‚Äçüè´</span>
                    <span class="text">Professional Instructor</span>
                  </li>
                  <li>
                    <span class="icon">üì∏</span>
                    <span class="text">Photo documentation</span>
                  </li>
                  <li>
                    <span class="icon">üöø</span>
                    <span class="text">Shower facilities</span>
                  </li>
                </ul>

                <div class="pkg-footer">
                  <div class="pax-control-wrapper">
                    <span class="pax-label">Pax</span>
                    <div class="pax-controls">
                      <button class="pax-btn decrease">-</button>
                      <span class="pax-number">1</span>
                      <button class="pax-btn increase">+</button>
                    </div>
                  </div>

                  <div class="pax-total-box">
                    <span class="label">Total Price</span>
                    <span class="value pax-total">Rp 250K</span>
                  </div>

                  <a href="#" class="btn btn-primary book-btn">Book Now</a>
                </div>
              </div>
            </div>
          </div>

          <!-- Pkg 4 -->
          <div class="swiper-slide">
            <div
              class="pkg-card intensive-package"
              data-id="4"
              data-base-price="0"
            >
              <div class="pkg-header special-header">
                <h3 class="pkg-title">INTENSIVE TRIP</h3>
                <div class="pkg-price-box">
                  <span class="amount">Custom</span>
                  <span class="duration">Flexible</span>
                </div>
              </div>
              <div class="pkg-body">
                <ul class="pkg-features">
                  <li>
                    <span class="icon">‚ú®</span>
                    <span class="text">Fully customized trip</span>
                  </li>
                  <li>
                    <span class="icon">üìÖ</span>
                    <span class="text">Flexible duration</span>
                  </li>
                  <li>
                    <span class="icon">üèÑ‚Äç‚ôÇÔ∏è</span>
                    <span class="text">Intensive coaching</span>
                  </li>
                  <li>
                    <span class="icon">üè®</span>
                    <span class="text">Premium accommodation</span>
                  </li>
                  <li>
                    <span class="icon">üí¨</span>
                    <span class="text">Price negotiable</span>
                  </li>
                </ul>

                <div class="pkg-footer">
                  <div class="custom-pax-info">
                    <p>Tailored specifically for you and your group needs.</p>
                  </div>
                  <a
                    href="https://wa.me/6285183001691?text=Hi! I'm interested in the INTENSIVE SURFING TRIP custom package."
                    target="_blank"
                    class="btn btn-primary intensive-btn"
                    >Chat to Discuss</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Swiper Nav -->
        <button
          class="swiper-button-prev swiper-nav-button"
          aria-label="Previous package"></button>
        <button
          class="swiper-button-next swiper-nav-button"
          aria-label="Next package"></button>
      </div>
      <div class="swiper-pagination-container">
        <div class="swiper-pagination packages-pagination"></div>
      </div>
    </div>
  </div>
</section>

<style>
  /* Base Layout */
  .packages-section {
    background-color: #f9fafb;
    padding: 60px 0 80px;
    overflow: hidden; /* Prevent horizontal scroll on body */
  }

  .packages-swiper-container {
    padding: 40px 0; /* Padding top/bottom for shadows */
    overflow: visible;
  }
  
  /* Swiper visible overflow to show shadows/peeking slides */
  .packages-swiper {
    overflow: visible !important;
  }

  /* Swiper wrapper adjustment for equal height */
  :global(.packages-swiper .swiper-wrapper) {
    align-items: stretch;
  }

  /* Swiper Slide Height Fix */
  .swiper-slide {
    height: auto !important;
    display: flex;
    justify-content: center;
    padding: 10px;
    transition: transform 0.3s ease;
  }
  
  /* Mobile: Force slide width for centering + peek */
  @media (max-width: 639px) {
    .swiper-slide {
        width: 85% !important; /* Shows ~7.5% of neighbors */
    }
  }

  /* Active State for Mobile only (Scaled up) */
  @media (max-width: 767px) {
    :global(.swiper-slide-active .pkg-card) {
      transform: scale(1.02);
      box-shadow: 0 20px 40px rgba(237, 154, 85, 0.15);
      border-color: rgba(237, 154, 85, 0.2);
      z-index: 2;
    }
  }
  
  /* Card Design */
  .pkg-card {
    background: white;
    border-radius: 24px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
    overflow: hidden;
    width: 100%;
    display: flex;
    flex-direction: column;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border: 1px solid rgba(0, 0, 0, 0.03);
    height: 100%; 
    position: relative;
    z-index: 1;
  }
  
  /* Desktop Hover - Toned down */
  @media(min-width: 1024px) {
    .pkg-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 15px 30px rgba(237, 154, 85, 0.1);
    }
  }

  /* Header */
  .pkg-header {
    background: linear-gradient(135deg, #ed9a55 0%, #e67e22 100%);
    color: white;
    padding: 32px 24px;
    text-align: center;
    position: relative;
    border-bottom-left-radius: 50% 20px;
    border-bottom-right-radius: 50% 20px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    /* Ensure header takes enough space for 2-line titles to align others */
    min-height: 180px; 
  }

  .intensive-package .pkg-header {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
  }

  .pkg-tag {
    position: absolute;
    top: 16px;
    right: 16px;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(4px);
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .pkg-title {
    font-size: 1.5rem;
    font-weight: 800;
    margin: 0 0 12px;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    /* Enforce 2-line height for consistency */
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    line-height: 1.2;
    min-height: 3.6rem; 
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .pkg-price-box {
    display: flex;
    justify-content: center;
    align-items: baseline;
    gap: 4px;
  }

  /* ... (Rest of CSS unchanged) ... */
  .pkg-price-box .currency { font-size: 1rem; font-weight: 500; opacity: 0.9; }
  .pkg-price-box .amount { font-size: 2.25rem; font-weight: 800; line-height: 1; }
  .pkg-price-box .duration { font-size: 0.875rem; font-weight: 500; opacity: 0.8; }
  .pkg-body { padding: 24px; display: flex; flex-direction: column; flex: 1; }
  .pkg-features { list-style: none; padding: 0; margin: 0 0 24px; flex: 1; }
  .pkg-features li { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; color: #4b5563; font-size: 0.95rem; text-align: left; }
  .pkg-features .icon { font-size: 1.2rem; min-width: 24px; text-align: center; }
  .pkg-features .text { line-height: 1.4; }
  .pkg-footer { border-top: 1px solid #f3f4f6; padding-top: 20px; margin-top: auto; display: flex; flex-direction: column; gap: 16px; }
  .pax-control-wrapper { display: flex; justify-content: space-between; align-items: center; }
  .pax-label { font-weight: 600; color: #374151; font-size: 0.9rem; }
  .pax-controls { display: flex; align-items: center; background: #f3f4f6; border-radius: 12px; padding: 4px; }
  .pax-btn { width: 28px; height: 28px; border: none; background: white; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: 700; color: #ed9a55; cursor: pointer; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); transition: transform 0.1s; }
  .pax-btn:hover { transform: scale(1.1); }
  .pax-btn:active { transform: scale(0.95); }
  .pax-number { width: 32px; text-align: center; font-weight: 700; color: #1f2937; }
  .pax-total-box { display: flex; justify-content: space-between; align-items: center; background: #fff7ed; padding: 12px 16px; border-radius: 12px; border: 1px solid #ffedd5; }
  .pax-total-box .label { font-size: 0.85rem; color: #9a3412; font-weight: 500; }
  .pax-total-box .value { font-size: 1.1rem; color: #c2410c; font-weight: 800; }
  .custom-pax-info { text-align: center; background: #f0f9ff; padding: 12px; border-radius: 12px; color: #0369a1; font-size: 0.9rem; border: 1px solid #e0f2fe; }
  .book-btn { width: 100%; justify-content: center; padding: 14px; font-size: 1rem; margin-top: 4px; }
</style>

<script>
  import Swiper from "swiper";
  import { Navigation, Pagination } from "swiper/modules";

  // Swiper Init
  new Swiper(".packages-swiper", {
    modules: [Navigation, Pagination],
    loop: false,
    grabCursor: true,
    autoplay: false,
    autoHeight: false, 
    
    // Core Mobile Layout: Auto width + Centered
    slidesPerView: "auto",
    centeredSlides: true,
    spaceBetween: 20,
    // centeredSlidesBounds removed to ensure first slide is centered
    
    pagination: {
      el: ".packages-pagination",
      type: "progressbar",
      clickable: true,
    },
    navigation: {
      nextEl: ".swiper-button-next",
      prevEl: ".swiper-button-prev",
    },
    breakpoints: {
      // Tablet - Grid
      640: { 
        slidesPerView: 2, 
        spaceBetween: 24, 
        centeredSlides: false 
      },
      // Desktop - Grid
      1024: { 
        slidesPerView: 3, 
        spaceBetween: 32,
        centeredSlides: false
      },
    },
    on: {
      init: function (swiper) {
        const prev = swiper.navigation.prevEl;
        const next = swiper.navigation.nextEl;
        if (prev)
          prev.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>`;
        if (next)
          next.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>`;
      },
    },
  });

  // PAX Logic
  const packages = {
    1: { name: "Surf & Camp", price: 750000 },
    5: { name: "Sore di desa, Pagi di ombak", price: 750000 },
    2: { name: "One Day Trip", price: 350000 },
    3: { name: "Surf Only", price: 250000 },
  };

  document.querySelectorAll(".pkg-card").forEach((card) => {
    const id = card.getAttribute("data-id");
    if (!id || id === "4") return; // Custom package

    let count = 1;
    const price = parseInt(card.getAttribute("data-base-price") || "0");
    const displaySpan = card.querySelector(".pax-number");
    const totalDiv = card.querySelector(".pax-total");
    const decreaseBtn = card.querySelector(".decrease");
    const increaseBtn = card.querySelector(".increase");
    const bookBtn = card.querySelector(".book-btn");

    const update = () => {
      if (displaySpan) displaySpan.textContent = count.toString();
      const total = count * price;

      // Simple K format: 800000 -> 800K
      const kValue = total / 1000;
      if (totalDiv) totalDiv.textContent = `Rp ${kValue}K`;

      if (bookBtn) {
        // cast id to keyof typeof packages or just any for simplicity in this script context
        const pkgData = packages[id as unknown as keyof typeof packages];
        const pkgName = pkgData ? pkgData.name : 'Trip';
        const text = `Hi, I want to book ${pkgName} for ${count} pax. Total: Rp ${kValue}K`;
        bookBtn.setAttribute(
          "href",
          `https://wa.me/6285183001691?text=${encodeURIComponent(text)}`
        );
        bookBtn.setAttribute("target", "_blank");
      }
    };

    decreaseBtn?.addEventListener("click", () => {
      if (count > 1) {
        count--;
        update();
      }
    });

    increaseBtn?.addEventListener("click", () => {
      count++;
      update();
    });

    // Init
    update();
  });
</script>
